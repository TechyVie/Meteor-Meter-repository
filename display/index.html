<!DOCTYPE html>
<html>
<head>
    <title>Meteor Meter</title>
    <meta charset="utf-8">
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(120deg, #f6ffe3 80%, #cde7ff 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        .container {
            max-width: 500px;
            margin: 40px auto 0 auto;
            background: #fffbe6;
            border-radius: 12px;
            box-shadow: 0 4px 32px rgba(80,120,60,0.07);
            padding: 32px 28px 24px 28px;
        }
        h1 {
            text-align: center;
            font-size: 2.3rem;
            font-weight: 700;
            color: #386641;
            margin-bottom: 32px;
            letter-spacing: 1px;
        }
        #map-container {
            margin-bottom: 28px;
            min-height: 400px;
            height: 400px;
            width: 100%;
            background: linear-gradient(120deg, #eaf2d7 60%, #d5e6f3 100%);
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(56,102,65,0.07);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        .coords {
            display: flex;
            flex-wrap: wrap;
            gap: 18px 25px;
            align-items: center;
            font-size: 1.08rem;
            margin-top: 10px;
            margin-bottom: 16px;
        }
        .coords label {
            font-weight: 500;
            color: #386641;
            margin-right: 5px;
        }
        .coords input[type="number"] {
            padding: 7px 12px;
            border-radius: 6px;
            border: 1.5px solid #b7e4c7;
            background: #f7fff2;
            box-shadow: 0 1px 4px rgba(56,102,65,0.06);
            font-size: 1rem;
            width: 120px;
            transition: border-color 0.2s;
        }
        .coords input[type="number"]:focus {
            border-color: #386641;
            outline: none;
        }
        .impact-label {
            font-weight: bold;
            color: #c21807;
            margin-left: 16px;
            font-size: 1.1rem;
            letter-spacing: 1px;
        }
        .actions {
            margin-top: 10px;
            display: flex;
            justify-content: flex-end;
        }
        .actions button {
            background: #386641;
            color: #fff;
            font-size: 1.05rem;
            font-weight: 600;
            padding: 8px 24px;
            border-radius: 6px;
            border: none;
            box-shadow: 0 2px 8px rgba(56,102,65,0.12);
            cursor: pointer;
            transition: background 0.18s;
        }
        .actions button:hover {
            background: #52b788;
        }
        @media (max-width: 720px) {
            .container { max-width: 97%; padding: 12px; }
            #map-container { min-height: 220px; height: 220px; }
            .coords { flex-direction: column; gap: 12px 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Meteor Impact Map</h1>
        <div id="map-container"></div>
        <div class="coords">
            <label for="latitude">Impact Latitude:</label>
            <input id="latitude" type="number" step="0.0001" placeholder="e.g. 34.0522">
            <label for="longitude">Impact Longitude:</label>
            <input id="longitude" type="number" step="0.0001" placeholder="e.g. -118.2437">
            <label for="diameter">Meteor Diameter:</label>
            <input id="diameter" type="number" step="0.01" placeholder="e.g. 10.5">
            <label for="speed">Meteor Speed:</label>
            <input id="speed" type="number" step="0.01" placeholder="e.g. 20.2">
            <span class="impact-label" id="impact-status"></span>
        </div>
        <div class="actions">
            <button id="calc-btn" type="button">Simulate Meteor Impact</button>
        </div>
    </div>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>
    <script>
      // Set up a simple world map using D3.js with zoom
      const width = document.getElementById('map-container').offsetWidth;
      const height = 400;

      const svg = d3.select("#map-container")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("cursor", "crosshair");

      // Use a simple equirectangular projection
      const projection = d3.geoEquirectangular()
        .scale(width / 6.5)
        .translate([width / 2, height / 2]);

      const path = d3.geoPath().projection(projection);

      // Add a group for all map features so we can zoom it
      const g = svg.append("g");

      // Fetch world map data (GeoJSON)
      d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(function(world) {
        const countries = topojson.feature(world, world.objects.countries).features;
        g.selectAll("path")
          .data(countries)
          .enter().append("path")
          .attr("fill", "#e7eaf6")
          .attr("stroke", "#b7e4c7")
          .attr("stroke-width", 0.7)
          .attr("d", path);
      });

      // D3 zoom behavior
      const zoom = d3.zoom()
        .scaleExtent([1, 10])
        .on("zoom", function(event) {
          g.attr("transform", event.transform);
        });

      svg.call(zoom);

      // Pin a point when the map is clicked
      svg.on("click", function(event) {
        // Transform mouse coordinates if zoomed
        const transform = d3.zoomTransform(svg.node());
        const [x, y] = d3.pointer(event, svg.node());
        // Inverse transform to get map coordinates
        const invX = (x - transform.x) / transform.k;
        const invY = (y - transform.y) / transform.k;
        let coords = projection.invert([invX, invY]);
        if (!coords) return;
        const [lon, lat] = coords;

        // Remove any previous pin
        svg.selectAll(".pin").remove();

        // Draw a pin (circle)
        g.append("circle")
          .attr("class", "pin")
          .attr("cx", invX)
          .attr("cy", invY)
          .attr("r", 8)
          .attr("fill", "#c21807")
          .attr("stroke", "#fff")
          .attr("stroke-width", 2);

        // Set the latitude/longitude inputs
        document.getElementById('latitude').value = lat.toFixed(4);
        document.getElementById('longitude').value = lon.toFixed(4);
      });

      // Calculate impact button logic
      document.getElementById('calc-btn').onclick = function() {
        const lat = parseFloat(document.getElementById('latitude').value);
        const lon = parseFloat(document.getElementById('longitude').value);
        const dia = parseFloat(document.getElementById('diameter').value);
        const speed = parseFloat(document.getElementById('speed').value);

        if(isNaN(lat) || isNaN(lon) || isNaN(dia) || isNaN(speed)) {
          document.getElementById('impact-status').textContent = 'Please fill all fields with valid numbers.';
          return;
        }
        const damageRadius = Math.round((dia * speed) / 55 * 100) / 100;
        let severity = 'Minor';
        if(damageRadius > 2) severity = 'Severe';
        else if(damageRadius > 1) severity = 'Moderate';
        document.getElementById('impact-status').textContent =
          `Impact Detected: ${severity} damage radius ${damageRadius} km`;
      };
    </script>
</body>
</html>
